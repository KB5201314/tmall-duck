# 🦆tmall-duck

这是一个用python实现的天猫精灵方糖2自动打卡工具，借助selenium实现淘宝模拟登录、用百度TTS实现文字转语音输出，通过企业微信消息来通知打卡状态。
该程序运行一次即尝试一次打卡，结合`crontab`可以实现每天定时打卡。可以运行在树莓派等电子玩具中。

## requirement

- python3
    - requests
    - selenium
    - chromedriver

- mpg123

    用于播放mp3音频，播放程序以及mp3文件存储路径可以在`speak.py`中修改。

    请确保使用该播放程序可以直接放出声音并且让天猫精灵听到。


## configuration
使用前先修改配置文件中的内容`config.json`

- 百度TTS
    需要使用到百度文字转语音api，有免费额度，领取基础音库的免费额度就可以了。注册一个应用并获取到`api_key`和`secret_key`。

- 企业微信
    需要先在企业微信中注册一个企业，在`我的企业`页面可以看到你所创建企业的`企业ID`，即`corpid`。然后转到`应用管理`-`应用`-`创建应用`。创建成功后可以获取到该应用的`agentid`和`secret`。

## run

使用如下命令运行

```shell
python ./main.py
```

输出如下：

```
--------- 触发打卡 ---------
当前系统时间：2020-09-20 14:30:20
连续打卡37天
进度 2/2
[已完成] 对我说 “晚间轻松的音乐”
[已完成] 对我说 “眼科小医生”
今日任务已完成
--------- 打卡完毕 ---------
```

## 向开源致敬

本工具的原始创意来自于另一个冲鸭打卡姬项目：https://github.com/qoddi/node-tmall-bot/

该项目主要使用js实现。用autojs在手机上采集打卡信息，然后用http请求的形式向树莓派上运行的nodejs服务发送语音指令，树莓派通过蓝牙音箱播放给天猫精灵，项目设计采用了分布式的思路，扩展能力会强一些。

